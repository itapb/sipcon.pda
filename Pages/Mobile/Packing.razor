@page "/mobile-packing"
@using Sipcon.Mobile.WebApp.Layout
@inject NavigationManager navigationManager
@layout MobileLayout

@switch (CurrentStep)
{
    case Models.PackingStep.Customer:
        <PackingCustomers @bind-Value="CurrentStep" currentPacking="CurrentPacking" />
        break;
    case Models.PackingStep.PackingDetails:
        <PackingDetails @bind-Value="CurrentStep" currentPacking="CurrentPacking" />
        break;
    case Models.PackingStep.Package:
        <PackingPackage @bind-Value="CurrentStep" currentPacking="CurrentPacking" />
        break;
    case Models.PackingStep.Pending:
        <PackingPending @bind-Value="CurrentStep" currentPacking="CurrentPacking" />
        break;
    case Models.PackingStep.SetPackage:
        <PackingSetPackage @bind-Value="CurrentStep" currentPacking="CurrentPacking" />
        break;
    case Models.PackingStep.DispatchGuide:
        navigationManager.NavigateTo("mobile-dispatch");
        break;
}

@code {
    [Inject] private UserSession Session { get; set; } = null!;

    public Models.Packing CurrentPacking { get; set; } = new();
    public Models.PackingStep CurrentStep = Models.PackingStep.Customer;
    public static Models.PackingStep? PreviousStep;

    protected override async Task OnInitializedAsync()
    {
        // Aquí Session ya está disponible
        CurrentPacking = new Models.Packing
        {
            UserId = Session.UserId,
            SupplierId = Session.SupplierId,
            CustomerId = 0,
            PartId = 0,
            PackageId = 0,
            CustomerName = "",
            Pending = 0,
            PartName = "",
            Code = ""
        };

        await Task.CompletedTask;
    }
}
